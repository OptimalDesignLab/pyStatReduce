################################################################################
#
# plot_deterministic_trajectory.py
#
# This script plots the deterministic optimal trajectory, which is the altitude
# and angle of attach schedule.
#
################################################################################

import numpy as np
from mpl_toolkits import mplot3d
import matplotlib
import matplotlib.pyplot as plt

altitude_determ = np.array([  100.        ,   100.        ,   164.0557643 ,   218.11824534,   218.11824534,   594.87366893,  1884.81580942,  2500.06507343,
        2500.06507343,  3873.1995597 ,  5540.24615145,  5960.08519216,  5960.08519216,  6887.76706542,  8020.52078944,  8337.99144103,
        8337.99144103,  8804.73183899,  8791.21435824,  8607.8540786 ,  8607.8540786 ,  8063.55369594,  7333.01653081,  7194.34561926,
        7194.34561926,  7036.90966352,  7100.51166151,  7160.9019215 ,  7160.9019215 ,  7337.32623784,  7621.40509094,  7710.9464599 ,
        7710.9464599 ,  7914.46736459,  8185.63625057,  8268.88773658,  8268.88773658,  8456.13966968,  8699.65906157,  8771.14526332,
        8771.14526332,  8913.56513682,  9047.59333244,  9071.30566043,  9071.30566043,  9091.13009621,  9181.87442526,  9267.26464136,
        9267.26464136,  9758.6687448 , 11245.96312222, 11943.03478097, 11943.03478097, 13766.11714855, 16424.42017061, 17194.76290022,
       17194.76290022, 18705.88879153, 19906.99495105, 20000.        ])

alpha_determ = np.array([ 5.25785332,  3.15857677,  2.00379171,  2.05909018,  2.05909018,  2.19830428,  1.67107988,  1.33044273,  1.33044273,  0.75856589,  0.96709622,
        1.27409807,  1.27409807,  1.79404552,  1.4747259 ,  1.12320475,  1.12320475,  0.51909079,  0.79774599,  1.15462871,  1.15462871,  1.88423632,
        2.11754006,  2.00453926,  2.00453926,  1.69028129,  1.41218237,  1.36173408,  1.36173408,  1.28425648,  1.23436256,  1.23234371,  1.23234371,
        1.23633828,  1.2452507 ,  1.24889301,  1.24889301,  1.25024481,  1.22767657,  1.21463112,  1.21463112,  1.18368179,  1.14811301,  1.13857929,
        1.13857929,  1.22174169,  1.67813361,  1.90511518,  1.90511518,  2.48276626,  3.32068814,  3.59576372,  3.59576372,  3.93637717,  3.43860696,
        3.04727443,  3.04727443,  1.07224358, -4.77305466, -7.37684459])

tseries_deterministic = np.array([  0.        ,   7.65193556,  18.21004486,  21.55165035,  21.55165035,  29.20358591,  39.76169521,  43.1033007 ,  43.1033007 ,  50.75523626,
                            61.31334556,  64.65495105,  64.65495105,  72.30688661,  82.86499591,  86.2066014 ,  86.2066014 ,  93.85853696, 104.41664626, 107.75825175,
                           107.75825175, 115.41018731, 125.96829661, 129.3099021 , 129.3099021 , 136.96183766, 147.51994695, 150.86155245, 150.86155245, 158.51348801,
                           169.0715973 , 172.4132028 , 172.4132028 , 180.06513836, 190.62324765, 193.96485315, 193.96485315, 201.61678871, 212.174898  , 215.5165035 ,
                           215.5165035 , 223.16843906, 233.72654835, 237.06815385, 237.06815385, 244.72008941, 255.2781987 , 258.6198042 , 258.6198042 , 266.27173976,
                           276.82984905, 280.17145455, 280.17145455, 287.82339011, 298.3814994 , 301.7231049 , 301.7231049 , 309.37504046, 319.93314975, 323.27475524])

matplotlib.rcParams.update({'font.size': 16})
fname = 'deterministic_trajectory_schedule.pdf'
matplotlib.rcParams['mathtext.fontset'] = 'cm'
fig, axes = plt.subplots(nrows=2, figsize=(10,8))
p1 = axes[0].plot(tseries_deterministic, altitude_determ, color='k')
p2 = axes[0].plot(tseries_deterministic, altitude_determ,'o', color='k')
axes[0].set_ylabel(r'altitude $(m)$')
plt.tight_layout()
p3 = axes[1].plot(tseries_deterministic, alpha_determ, color='k')
p4 = axes[1].plot(tseries_deterministic, alpha_determ, 'o', color='k')
axes[1].set_ylabel(r'angle of attack, $\alpha$ $(^{\circ})$')
axes[1].set_xlabel(r'time (s)')
plt.tight_layout()
# plt.show()
plt.savefig(fname, format='pdf')
