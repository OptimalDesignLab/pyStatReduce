import numpy as np
from mpl_toolkits import mplot3d
import matplotlib
import matplotlib.pyplot as plt

grad_1e_1 = np.array([ -0.42168742,   1.56520454,  1.19683869,   0.06730494,    0.97452223,    0.75777531,  0.42919247,   2.42060219,    2.29845559,  0.58218726,
    2.63878666,   2.1773375 ,  0.67476611,   8.24377981,   15.81853654,    6.92962993, 38.31504472,  48.20651956,   15.01945152, 76.15467864,
   61.50455789,  18.43317549, 89.20365084,  68.53736096,   20.57461502,   96.95170645, 73.68787047,  21.7875476 ,  103.90769155, 79.00712669,
   23.65819948, 112.25796872, 86.3628179 ,  25.54168807,  124.43964026, -334.84485236, 27.63102014, 121.45194238, -346.56579383, 16.31532628,
 -152.61836345, -77.77795402,  4.20076905, 150.32289286, -380.11500681])
grad_1e_2 = np.array([  0.9126748 ,   1.46203608,   2.49739201,   0.06710563,   0.85711084,  -0.43435622,  -0.8976323 ,   2.59172057,   2.22560628,   1.88823736,   2.63804253,
   0.97695118,   0.6631085 ,   4.08971511,  19.86407004,   8.53986231,  54.05267132,  48.30857055,  14.99884713,  76.12339682,  61.0313624 ,  17.21498042,
  90.34642131,  67.70175335,  20.23193663,  95.68905205,  72.70754742,  21.69587083, 104.7344675 ,  77.95373576,  24.80030531, 110.63902106,  84.58232642,
  25.50498042, 125.09804731,  93.49863739,  26.74803479, 122.46600645,  59.31453923,  16.53658475,  53.68138867,  29.54054018,   4.91469075,  37.30524859,
  -9.94300439])

grad_5e_2 = np.array([ -0.4202156,   1.46264156,   1.19678212,   0.06720208,   0.85655634,  0.90314989,   0.42961905,  2.29488937,  2.22548075,   0.58360027,   2.27487578,
   2.35164605,   0.92912954 ,  3.13913404,  15.46655251,   7.27346476, 46.95336197,  48.29398072, 14.53970939, 75.54940931,  61.05480697,  18.41534729,
  89.31453008,  68.03831888 , 20.236571  ,  97.52839515,  73.7058686 , 21.70118723, 103.78561933, 78.97608689, 23.29410548, 112.04484095,  86.719039,
  25.51440419, 124.21194298 , 94.60166743,  27.81357461, 123.97099925, 62.42476238,  15.08476824, 53.63353474, 27.95729525,   4.64023612,  40.24128934,
 -36.08844438])

grad_1e_3 = np.array([-0.41978242,  14.66225478,  1.19644552,   0.06527082, -12.3863948 , -12.34144859,  0.4304395 ,  2.59155275, 15.39978098,   0.58483249,   2.6379522,
   2.35286017,   0.66249285,  2.84976792,   3.65597561,  21.03346701,  54.05211778, 48.30677096, 14.99950293, 76.11798455,  61.03230713,  18.40924045,
 102.24607599,  67.69822564, 20.23306769, 109.79169004,  72.70049143,  21.69633962, 90.17407463, 77.94819839, 36.70443828, 110.63261851,  85.1843724,
  25.50575463, 122.71340332, 93.49311238,  14.84148958, 110.23217909,  57.10999887, 15.09278323, 67.34177184, 14.99088238,   5.14095633,  36.37002004,
  -9.60895225])

grad_1e_4 = np.array([ -0.4197826 ,   1.40239325,  1.15233288, 132.36673157,    0.85714718,   0.90181032,    0.43043886, -129.73468551,   2.11374722,   0.58483183,
    2.63794995,   2.35286652,  0.66248554,   2.84969051,   19.93827553,   8.54143892,  -80.67702526,   48.30677956,  14.99951002,  76.11800506,
   61.0323285 ,  18.40924958, 88.27392247, -64.00090917, -111.88635665, 228.86141311,   72.70043993,  154.19381864, -28.89564352,  77.94814651,
  155.7748785 , 110.63260961, 85.18439778,  25.50577944,  122.71338756, 226.58121478, -104.22898596,  122.44624417,  56.97413601, 147.51452854,
   53.68455692,  27.99680701,  5.14729739,  36.24629906, -141.33492438])
grad_1e_5 = np.array([-0.41978549, -1321.57324252,     1.19644228,    0.06709995, -1322.16178175,  0.90180733,  0.43044093,     2.59155147, 1325.1751515,
 0.58483488, -1320.46237096, -1320.70426127, 1323.66784817,     2.84968706, 19.93828524,  8.54143767,    54.0521122 ,  48.30677808,
 14.99950974,    76.11800584,    61.03232777, 1341.54406144,    88.27392364, 67.69779411, 20.23308336,    95.67898226,  72.70043833,
 21.6963704 ,   102.50989639,    77.94814506, 1346.47978243,   110.63261053, 85.18439433, 25.50577986,   122.71338723,  93.49312418,
 27.83805898,  1446.46680058,    56.97276284, 1338.2194376 ,    53.68821725, 27.9968046 ,  5.14736072, -1286.45740957,  -8.96130485])
grad_1e_6 = np.array([    -0.4197752 ,     1.46200631,     1.19643099, -13229.98832623,     0.85714598, -13229.16587463,     0.43044352, -13227.48863782,  13232.22419367,
      0.58482667, 13232.59761665,     2.35285802,      0.66247773, 13232.85056679,     19.93831236,     8.54145077,     54.05208015, -13182.31058985,
 -13215.2422249 ,    75.57954234,    61.03234426,     18.40923528,    88.27393819, -13161.75487574, 13250.46869979,     95.67898181,     72.70043548,
     21.69638989,   102.50985488,    77.94815181, -13206.58017445,   110.63261212,     85.1843719 ,    25.50578074,  13353.81158157,     93.49311361,
     27.83805897,   122.4462151 , 13287.53904852,     15.09311028,    53.68455177,     27.99680465, 13235.24122975,  13266.60234056,     -9.10381411])

grad_ind = np.arange(grad_1e_2.size)

fname = "gradients_line.pdf"
# plt.rc('text', usetex=True)
matplotlib.rcParams['mathtext.fontset'] = 'cm'
fig = plt.figure("gradients", figsize=(13,6))
ax = plt.axes()
# sp1 = ax.plot(grad_ind, grad_1e_1, '^', mfc='none',  label='1.e-1', ms=12, lw=2)
# sp2 = ax.plot(grad_ind, grad_1e_2, 'o', mfc='none', label='1.e-2', ms=12, lw=2)
sp1 = ax.plot(grad_ind, grad_1e_1, label='1.e-1', lw=2)
sp2 = ax.plot(grad_ind, grad_1e_2, label='1.e-2', lw=2)
# sp2_5 = ax.plot(grad_ind, grad_5e_2, '1', mfc='none', label='5.e-2', ms=14, lw=2)
# sp3 = ax.plot(grad_ind, grad_1e_3, 'v', mfc='none', label='1.e-3', ms=12, lw=2)
# sp4 = ax.plot(grad_ind, grad_1e_4, 'D', mfc='none', label='1.e-4', ms=10, lw=2)
# sp5 = ax.plot(grad_ind, grad_1e_5, '>', label='1.e-5', ms=12, lw=2)
# sp6 = ax.plot(grad_ind, grad_1e_6, '<', label='1.e-6', ms=12, lw=2)
ax.set_xlabel('Gradient Index')
ax.set_ylabel('Gradient Value')
plt.xticks(np.arange(45, step=5))
ax.legend()
plt.grid(True)
plt.tight_layout()
# plt.show()
plt.savefig(fname, format='pdf')
